<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flashcard</title>
    <style>
        * {
            box-sizing: border-box;
        }
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 15px;
            max-width: 100%;
            overflow-x: hidden;
        }
        h1 {
            font-size: clamp(20px, 5vw, 28px);
            margin: 10px 0 20px 0;
        }
        .button-container {
            margin: 15px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .vocab-button {
            padding: 10px 15px;
            font-size: clamp(14px, 3vw, 16px);
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            flex: 1 1 auto;
            min-width: 100px;
        }
        .vocab-button:hover {
            background-color: #45a049;
        }
        .vocab-button.active {
            background-color: #2196F3;
        }
        .mode-button {
            padding: 10px 15px;
            font-size: clamp(14px, 3vw, 16px);
            cursor: pointer;
            background-color: #FF9800;
            color: white;
            border: none;
            border-radius: 5px;
            flex: 1 1 auto;
            min-width: 80px;
        }
        .mode-button:hover {
            background-color: #F57C00;
        }
        .mode-button.active {
            background-color: #E91E63;
        }
        
        .flashcard-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 20px;
            width: 100%;
        }
        .flashcard {
            width: min(500px, 95vw);
            height: min(300px, 60vh);
            background: white;
            border: 2px solid #333;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: transform 0.3s;
            padding: 20px;
            position: relative;
        }
        .flashcard:hover {
            transform: scale(1.02);
        }
        .flashcard.flipped {
            background: #f0f0f0;
        }
        .card-number {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: clamp(12px, 2.5vw, 14px);
            color: #666;
        }
        .card-word {
            font-size: clamp(32px, 8vw, 48px);
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
            word-break: break-word;
        }
        .card-reading {
            font-size: clamp(18px, 4vw, 24px);
            color: #666;
            margin-bottom: 20px;
            text-align: center;
        }
        .card-meaning {
            font-size: clamp(22px, 5vw, 28px);
            color: #333;
            margin-bottom: 10px;
            text-align: center;
            word-break: break-word;
        }
        .card-english {
            font-size: clamp(16px, 3.5vw, 20px);
            color: #666;
            text-align: center;
        }
        .flashcard-controls {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            width: 100%;
            max-width: 300px;
            justify-content: center;
        }
        .control-btn {
            padding: 12px 20px;
            font-size: clamp(14px, 3vw, 16px);
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: #2196F3;
            color: white;
            flex: 1;
            min-width: 50px;
        }
        .control-btn:hover {
            background-color: #1976D2;
        }
        .control-btn:disabled {
            background-color: #ccc;
        }
        .progress {
            margin-top: 10px;
            font-size: clamp(14px, 3vw, 18px);
            color: #666;
            text-align: center;
        }
        .speed-control {
            margin-top: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
        }
        .speed-control label {
            width: 100%;
            text-align: center;
            margin-bottom: 5px;
            display: none;
        }
        .speed-btn {
            padding: 10px 18px;
            font-size: clamp(13px, 2.8vw, 16px);
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: #9E9E9E;
            color: white;
        }
        .speed-btn:hover {
            background-color: #757575;
        }
        .speed-btn.active {
            background-color: #000000;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 30px;
            font-size: clamp(12px, 2.5vw, 14px);
            overflow-x: auto;
            display: block;
        }
        th, td {
            border: 1px solid #000;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f0f0f0;
            font-weight: bold;
        }
        .hidden {
            color: transparent;
            background-color: #ddd;
            user-select: none;
            cursor: pointer;
        }
        .hidden:hover {
            background-color: #ccc;
        }
        h2 {
            margin-top: 30px;
            font-size: clamp(18px, 4vw, 24px);
        }
        .table-view {
            display: none;
        }
        .flashcard-view {
            display: block;
        }

        .audio-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 8px 10px;
            font-size: clamp(16px, 3vw, 20px);
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: #c4c4c4;
            color: rgb(255, 255, 255);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .audio-btn:hover {
            background-color: #000000;
        }
        .settings-control {
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .checkbox-label {
            margin-left: 8px;
            font-size: clamp(14px, 3vw, 16px);
        }
        
        @media (max-width: 600px) {
            body {
                padding: 10px;
            }
            .flashcard {
                border-radius: 10px;
                padding: 15px;
            }
            .speed-btn, .control-btn, .vocab-button, .mode-button {
                touch-action: manipulation;
                -webkit-tap-highlight-color: transparent;
            }
        }
    </style>
</head>
<body>
    <h1>Japanese Core Vocabulary</h1>
    
    <div class="button-container">
        <button class="vocab-button active" onclick="loadVocab('core1000', this)">Core 1000</button>
        <button class="vocab-button" onclick="loadVocab('core2000', this)">Core 2000</button>
        <button class="vocab-button" onclick="loadVocab('core3000', this)">Core 3000</button>
    </div>
    
    <div class="button-container">
        <button class="mode-button active" onclick="setMode('flashcard', this)">Flashcard</button>
        <button class="mode-button" onclick="setMode('showAll', this)">all</button>
        <button class="mode-button" onclick="setMode('hideJapanese', this)">definition</button>
        <button class="mode-button" onclick="setMode('hideMeaning', this)">words</button>
    </div>
    
    <div id="flashcard-view" class="flashcard-view">
        <div class="flashcard-container">
            <div class="flashcard" id="flashcard" onclick="flipCard()">
                <div class="card-number" id="cardNumber"></div>
                <button class="audio-btn" onclick="playAudio(event)">üîä</button>
                <div id="cardFront">
                    <div class="card-word" id="cardWord"></div>
                    <div class="card-reading" id="cardReading"></div>
                </div>
                <div id="cardBack" style="display:none;">
                    <div class="card-meaning" id="cardMeaning"></div>
                    <div class="card-english" id="cardEnglish"></div>
                </div>
            </div>
            
            <div class="flashcard-controls">
                <button class="control-btn" onclick="prevCard()" id="prevBtn">‚Üê</button>
                <button class="control-btn" onclick="toggleAutoPlay()" id="autoPlayBtn">‚ñ∂</button>
                <button class="control-btn" onclick="nextCard()" id="nextBtn">‚Üí</button>
            </div>
            
            <div class="speed-control">
                <button class="speed-btn" onclick="setSpeed(2000,this)">‰ΩéÈÄü</button>
                <button class="speed-btn active" onclick="setSpeed(1000,this)">Ê®ôÊ∫ñ</button>
                <button class="speed-btn" onclick="setSpeed(500,this)">È´òÈÄü</button>
            </div>
            
            <div class="settings-control">
                <input type="checkbox" id="autoAudioCheck" checked>
                <label class="checkbox-label" for="autoAudioCheck">Ëá™ÂãïÈü≥Â£∞ÂÜçÁîü</label>
            </div>
            
            <div class="progress" id="progress"></div>
        </div>
    </div>
    
    <div id="table-view" class="table-view"></div>
    <script src="core1000.js"></script>
    <script src="core2000.js"></script>
    <script src="core3000.js"></script>
    <script>
        let currentVocab = 'core1000';
        let currentMode = 'flashcard';
        let currentData = null;
        let allWords = [];
        let currentIndex = 0;
        let isFlipped = false;
        let autoPlayInterval = null;
        let autoPlaySpeed = 1000;
        let speechSynthesis = window.speechSynthesis;
        let japaneseVoice = null;

        function initVoice() {
            const voices = speechSynthesis.getVoices();
            japaneseVoice = voices.find(voice => voice.lang === 'ja-JP');
            if (!japaneseVoice) {
                japaneseVoice = voices.find(voice => voice.lang.startsWith('ja'));
            }
            console.log('Available voices:', voices.length);
            console.log('Japanese voice:', japaneseVoice);
        }

        speechSynthesis.onvoiceschanged = initVoice;
        setTimeout(initVoice, 100);

        function loadVocab(vocabType, buttonElement) {
            document.querySelectorAll('.vocab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            buttonElement.classList.add('active');
            
            currentVocab = vocabType;
            
            if (vocabType === 'core1000') {
                currentData = core1000;
            } else if (vocabType === 'core2000') {
                currentData = core2000;
            } else if (vocabType === 'core3000') {
                currentData = core3000;
            }
            
            prepareWordList();
            currentIndex = 0;
            
            if (currentMode === 'flashcard') {
                showCard();
            } else {
                displayVocabulary();
            }
        }

        function setMode(mode, buttonElement) {
            document.querySelectorAll('.mode-button').forEach(btn => {
                btn.classList.remove('active');
            });
            buttonElement.classList.add('active');
            
            currentMode = mode;
            
            if (mode === 'flashcard') {
                document.getElementById('flashcard-view').style.display = 'block';
                document.getElementById('table-view').style.display = 'none';
                prepareWordList();
                showCard();
            } else {
                document.getElementById('flashcard-view').style.display = 'none';
                document.getElementById('table-view').style.display = 'block';
                stopAutoPlay();
                displayVocabulary();
            }
        }

        function prepareWordList() {
            allWords = [];
            for (let i = 1; i <= 10; i++) {
                const key = `core${i}`;
                if (currentData[key]) {
                    currentData[key].forEach((item, index) => {
                        allWords.push({
                            number: (index + 1) + ((i - 1) * 100),
                            ...item
                        });
                    });
                }
            }
        }

        function showCard() {
            if (allWords.length === 0) return;
            
            const word = allWords[currentIndex];
            document.getElementById('cardNumber').textContent = `${currentIndex + 1} / ${allWords.length}`;
            document.getElementById('cardWord').textContent = word.word;
            document.getElementById('cardReading').textContent = word.reading;
            document.getElementById('cardMeaning').textContent = word.korean;
            document.getElementById('cardEnglish').textContent = word.meaning;
            
            document.getElementById('cardFront').style.display = 'block';
            document.getElementById('cardBack').style.display = 'none';
            document.getElementById('flashcard').classList.remove('flipped');
            isFlipped = false;
            
            document.getElementById('progress').textContent = `Card ${currentIndex + 1} of ${allWords.length}`;
            document.getElementById('prevBtn').disabled = currentIndex === 0;
            document.getElementById('nextBtn').disabled = currentIndex === allWords.length - 1;
        
            if (document.getElementById('autoAudioCheck').checked) {
                setTimeout(() => playAudio(), 100);
            }
        }

        function flipCard() {
            isFlipped = !isFlipped;
            if (isFlipped) {
                document.getElementById('cardFront').style.display = 'none';
                document.getElementById('cardBack').style.display = 'block';
                document.getElementById('flashcard').classList.add('flipped');
            } else {
                document.getElementById('cardFront').style.display = 'block';
                document.getElementById('cardBack').style.display = 'none';
                document.getElementById('flashcard').classList.remove('flipped');
            }
        }

        function nextCard() {
            if (currentIndex < allWords.length - 1) {
                currentIndex++;
                showCard();
            }
        }

        function prevCard() {
            if (currentIndex > 0) {
                currentIndex--;
                showCard();
            }
        }

        function toggleAutoPlay() {
            if (autoPlayInterval) {
                stopAutoPlay();
            } else {
                startAutoPlay();
            }
        }

        function startAutoPlay() {
            document.getElementById('autoPlayBtn').textContent = '‚è∏';
            autoPlayInterval = setInterval(() => {
                if (!isFlipped) {
                    flipCard();
                } else {
                    if (currentIndex < allWords.length - 1) {
                        nextCard();
                    } else {
                        stopAutoPlay();
                    }
                }
            }, autoPlaySpeed);
        }

        function stopAutoPlay() {
            if (autoPlayInterval) {
                clearInterval(autoPlayInterval);
                autoPlayInterval = null;
                document.getElementById('autoPlayBtn').textContent = '‚ñ∂';
            }
        }

        function setSpeed(speed, buttonElement) {
            autoPlaySpeed = speed;
            
            document.querySelectorAll('.speed-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            buttonElement.classList.add('active');
            
            if (autoPlayInterval) {
                stopAutoPlay();
                startAutoPlay();
            }
        }

        function displayVocabulary() {
            let html = '';
            
            for (let i = 1; i <= 10; i++) {
                const key = `core${i}`;
                if (currentData[key]) {
                    html += `<h2>Core ${i}</h2>`;
                    html += '<table>';
                    html += '<tr><th>number</th><th>Word</th><th>Reading</th><th>Korean</th><th>Meaning</th></tr>';
                    
                    currentData[key].forEach((item, index) => {
                        html += '<tr>';
                        html += `<td>${(index + 1) + ((i - 1) * 100)}</td>`;
                        
                        if (currentMode === 'hideJapanese') {
                            html += `<td class="hidden" onclick="this.classList.toggle('hidden')">${item.word}</td>`;
                            html += `<td class="hidden" onclick="this.classList.toggle('hidden')">${item.reading}</td>`;
                            html += `<td>${item.korean}</td>`;
                            html += `<td>${item.meaning}</td>`;
                        } else if (currentMode === 'hideMeaning') {
                            html += `<td>${item.word}</td>`;
                            html += `<td>${item.reading}</td>`;
                            html += `<td class="hidden" onclick="this.classList.toggle('hidden')">${item.korean}</td>`;
                            html += `<td class="hidden" onclick="this.classList.toggle('hidden')">${item.meaning}</td>`;
                        } else {
                            html += `<td>${item.word}</td>`;
                            html += `<td>${item.reading}</td>`;
                            html += `<td>${item.korean}</td>`;
                            html += `<td>${item.meaning}</td>`;
                        }
                        
                        html += '</tr>';
                    });
                    
                    html += '</table>';
                }
            }
            
            document.getElementById('table-view').innerHTML = html;
        }

        function playAudio(event) {
            if (event) {
                event.stopPropagation();
            }
            
            if (allWords.length === 0) return;
            
            const word = allWords[currentIndex];
            const utterance = new SpeechSynthesisUtterance(word.word);
            utterance.lang = 'ja-JP';
            utterance.rate = 0.8;
            
            if (japaneseVoice) {
                utterance.voice = japaneseVoice;
            }
            
            speechSynthesis.cancel();
            speechSynthesis.speak(utterance);
        }

        // ÌÇ§Î≥¥Îìú Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï∂îÍ∞Ä
        document.addEventListener('keydown', function(event) {
            // ÏûÖÎ†• ÌïÑÎìúÏóêÏÑú ÌÉÄÏù¥Ìïë Ï§ëÏùº ÎïåÎäî Î¨¥Ïãú
            if (event.target.tagName === 'INPUT' || event.target.tagName === 'TEXTAREA') {
                return;
            }
            
            // Ïä§ÌéòÏù¥Ïä§Î∞î: Ïπ¥Îìú Îí§ÏßëÍ∏∞ ÎòêÎäî ÏûêÎèôÏû¨ÏÉù
            if (event.code === 'Space') {
                event.preventDefault(); // ÌéòÏù¥ÏßÄ Ïä§ÌÅ¨Î°§ Î∞©ÏßÄ
                if (currentMode === 'flashcard') {
                    toggleAutoPlay();
                }
            }
            // ÏôºÏ™Ω ÌôîÏÇ¥Ìëú: Ïù¥Ï†Ñ Ïπ¥Îìú
            else if (event.code === 'ArrowLeft') {
                event.preventDefault();
                if (currentMode === 'flashcard') {
                    prevCard();
                }
            }
            // Ïò§Î•∏Ï™Ω ÌôîÏÇ¥Ìëú: Îã§Ïùå Ïπ¥Îìú
            else if (event.code === 'ArrowRight') {
                event.preventDefault();
                if (currentMode === 'flashcard') {
                    nextCard();
                }
            }
            else if (event.code === 'Enter') {
                event.preventDefault();
                if (currentMode === 'flashcard') {
                    flipCard();
                }
        }
    });

        currentData = core1000;
        prepareWordList();
        showCard();
    </script>
</body>
</html>